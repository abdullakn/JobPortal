{% extends 'employee/index.html' %}
<div class="careerfy-main-content">


{% block content %}
{% load static %}
<link href="{% static 'employees/css/cropper.min.css' %}" rel="stylesheet">

            
    <!-- Main Section -->
    <div class="careerfy-main-section careerfy-dashboard-fulltwo">
        <div class="container">
            <div class="row">

                <aside class="careerfy-column-3">
                    <div class="careerfy-typo-wrap">
                        <div class="careerfy-employer-dashboard-nav">
                            <figure>
                                <a href="#" class="employer-dashboard-thumb"><img src="extra-images/candidate-dashboard-navthumb.jpg" id="image" alt=""></a>
                                <figcaption>
                                    <div class="careerfy-fileUpload">
                                        <span><i class="careerfy-icon careerfy-add"></i> Upload Photo</span>
                                        <input type="file" class="careerfy-upload image" name="image" />
                                    </div>


                                 <!-- modal -->



                                 
         <div class="modal fade" id="modal"   role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="modalLabel">Crop image</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">Ã—</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="img-container">
                            <div class="row">
                                <div class="col-md-8">  
                                    <!--  default image where we will set the src via jquery-->
                                    <img id="image">
                                </div>
                                <div class="col-md-4">
                                    <div class="preview"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="crop">Crop</button>
                    </div>
                </div>
            </div>
        </div>



        <!-- modal -->



                                    <h2>{{request.user}}</h2>
                                    <span class="careerfy-dashboard-subtitle">UI/UX Designer</span>
                                </figcaption>
                            </figure>
                            <ul>
                                <li class="active"><a href="{% url 'employee_profile' %}"><i class="careerfy-icon careerfy-user"></i> My Profile</a></li>
                                <li><a href="{% url 'make_cv' %}"><i class="careerfy-icon careerfy-resume"></i> My Resume</a></li>
                                <li><a href="{% url 'view_cv' %}"><i class="careerfy-icon careerfy-resume"></i> View Resume </a></li>
                                <li><a href="{% url 'view_favourite' %}"><i class="careerfy-icon careerfy-heart"></i> Saved jobs</a></li>
                                <li><a href="{% url 'employee_appliedjobs' %}"><i class="careerfy-icon careerfy-briefcase-1"></i> Applied jobs</a></li>
                                <li><a href=""><i class="careerfy-icon careerfy-alarm"></i> Job Alerts</a></li>
                                <li><a href="{% url 'machine_test' %}"><i class="careerfy-icon careerfy-id-card"></i>Machine Test</a></li>
                                <li><a href="candidate-dashboard-changed-password.html"><i class="careerfy-icon careerfy-multimedia"></i> Change Password</a></li>
                                <li><a href="index-2.html"><i class="careerfy-icon careerfy-logout"></i> Logout</a></li>
                            </ul>
                        </div>
                    </div>
                </aside>

                {% block basic %}
                <div class="careerfy-column-9">
                    <div class="careerfy-typo-wrap">
                        <form class="careerfy-employer-dasboard" accept="" method="POST">{% csrf_token %}
                            <div class="careerfy-employer-box-section">
                                <div class="careerfy-profile-title"><h2>Basic Information</h2></div>
                                <ul class="careerfy-row careerfy-employer-profile-form">
                                    <li class="careerfy-column-6">
                                        <label>Your Name *</label>
                                        <input value="{{employee.name}}" onkeypress="return (event.charCode > 64 && event.charCode < 91) || (event.charCode > 96 && event.charCode < 123) || (event.charCode==32)"  name="name" type="text">
                                    </li>
                                    <li class="careerfy-column-6">
                                        <label>Email *</label>
                                        <input value="{{employee.email}}" name="email" type="text">
                                    </li>
                                    <!-- <li class="careerfy-column-6">
                                        <label>Date of Birth:</label>
                                        <div class="careerfy-three-column-row">
                                            <div class="careerfy-profile-select careerfy-three-column">
                                                <select>
                                                    <option>dd</option>
                                                    <option>dd</option>
                                                </select>
                                            </div>
                                            <div class="careerfy-profile-select careerfy-three-column">
                                                <select>
                                                    <option>mm</option>
                                                    <option>mm</option>
                                                </select>
                                            </div>
                                            <div class="careerfy-profile-select careerfy-three-column">
                                                <select>
                                                    <option>yyyy</option>
                                                    <option>yyyy</option>
                                                </select>
                                            </div>
                                        </div>
                                    </li> -->
                                    <li class="careerfy-column-6">
                                        <label>Phone *</label>
                                        <input value="{{employee.phone}}"  oninput="this.value = this.value.replace(/\D/g,'');" name="phone" type="text">
                                    </li>
                                    <!-- <li class="careerfy-column-6">
                                        <label>Category *</label>
                                        <div class="careerfy-profile-select">
                                            <select>
                                                <option>PHP Developer</option>
                                                <option>PHP Developer</option>
                                            </select>
                                        </div>
                                    </li> -->
                                    <li class="careerfy-column-6">
                                        <label>Experience</label>
                                        <input value="{{employee.experience}}"  oninput="this.value = this.value.replace(/\D/g,'');" name="experience"  type="text" required>
                                    </li>
                                    <li class="careerfy-column-6">
                                        <label>Specialization</label>
                                        <input  name="specialization" value="{{employee.specialization}}" type="text" required>
                                    </li>
                                   
                                    <li class="careerfy-column-6">
                                        <label>Place</label>
                                        <input value="{{employee.place}}" name="place" type="text">
                                    </li>
                                    <li class="careerfy-column-6">
                                        <label>Education Level *</label>
                                        <div class="careerfy-profile-select">
                                            <select name="education">
                                                {% if employee.education %}
                                                <option value="">{{employee.education}}</option>
                                                {% else %}
                                                <option value="">------</option>
                                                {% endif %}
                                                <option value="PG">PG</option>
                                                <option value="UG">UG</option>
                                                <option value="Plus 2">Plus 2</option>
                                                <option value="SSLC">SSLC</option>
                                            </select>
                                        </div>
                                    </li>
                                    <li class="careerfy-column-6">
                                        <label>Gender *</label>
                                        <div class="careerfy-profile-select">
                                            <select name="gender" >
                                                {% if employee.gender %}
                                                <option value="">{{employee.gender}}</option>
                                                {% else %}
                                                <option value="">------</option>
                                                {% endif %}
                                                <option  value="Male">Male</option>
                                                <option value="Female">Female</option>
                                                <option value="Others">Others</option>
                                               
                                            </select>
                                        </div>
                                    </li>
                                    <li class="careerfy-column-6">
                                        <label>Age</label>
                                        <input value="{{employee.age}}"  oninput="this.value = this.value.replace(/\D/g,'');" name="age" type="text" required>
                                    </li>
                                    <li class="careerfy-column-6">
                                        <label>DOB</label>
                                        <input value="{{employee.dob}}" name="dob" type="date" required style="height: 42px;width: 370px;">
                                    </li>
                                   
                                    <li class="careerfy-column-12">
                                        <label>Description *</label>
                                        <textarea  name="description">{{employee.description}}</textarea>
                                    </li>
                                </ul>
                            </div>
                            <!-- <div class="careerfy-employer-box-section">
                                <div class="careerfy-profile-title"><h2>Address / Location</h2></div>
                                <ul class="careerfy-row careerfy-employer-profile-form">
                                    <li class="careerfy-column-6">
                                        <label>Country *</label>
                                        <div class="careerfy-profile-select">
                                            <select>
                                                <option>United Kingdom</option>
                                                <option>United Kingdom</option>
                                            </select>
                                        </div>
                                    </li>
                                    <li class="careerfy-column-6">
                                        <label>Region *</label>
                                        <div class="careerfy-profile-select">
                                            <select>
                                                <option>London</option>
                                                <option>London</option>
                                            </select>
                                        </div>
                                    </li>
                                    <li class="careerfy-column-6">
                                        <label>City / Town *</label>
                                        <div class="careerfy-profile-select">
                                            <select>
                                                <option>London</option>
                                                <option>London</option>
                                            </select>
                                        </div>
                                    </li>
                                    <li class="careerfy-column-6">
                                        <label>Postcode *</label>
                                        <input value="746000" onblur="if(this.value == '') { this.value ='746000'; }" onfocus="if(this.value =='746000') { this.value = ''; }" type="text">
                                    </li>
                                    <li class="careerfy-column-10">
                                        <label>Full Address *</label>
                                        <input value="Ha Dong - Ha Noi - Viet Nam" onblur="if(this.value == '') { this.value ='Ha Dong - Ha Noi - Viet Nam'; }" onfocus="if(this.value =='Ha Dong - Ha Noi - Viet Nam') { this.value = ''; }" type="text">
                                    </li>
                                    <li class="careerfy-column-2">
                                        <button class="careerfy-findmap-btn">Find on Map</button>
                                    </li>
                                    <li class="careerfy-column-6">
                                        <label>Latitude</label>
                                        <input value="51.4935825" onblur="if(this.value == '') { this.value ='51.4935825'; }" onfocus="if(this.value =='51.4935825') { this.value = ''; }" type="text">
                                    </li>
                                    <li class="careerfy-column-6">
                                        <label>Longitude</label>
                                        <input value="-0.16803379999998924" onblur="if(this.value == '') { this.value ='-0.16803379999998924'; }" onfocus="if(this.value =='-0.16803379999998924') { this.value = ''; }" type="text">
                                    </li>
                                    <li class="careerfy-column-12">
                                        <div class="careerfy-profile-map"><iframe src="https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d22589232.038285658!2d-103.9763543971716!3d46.28054447273778!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2s!4v1507595834401"></iframe></div>
                                        <span class="careerfy-short-message">For the precise location, you can drag and drop the pin.</span>
                                    </li>
                                </ul>
                            </div> -->
                            <!-- <div class="careerfy-employer-box-section">
                                <div class="careerfy-profile-title"><h2>Other Information</h2></div>
                                <ul class="careerfy-row careerfy-employer-profile-form">
                                    <li class="careerfy-column-6">
                                        <label>Experience *</label>
                                        <div class="careerfy-profile-select">
                                            <select>
                                                <option>5 Years</option>
                                                <option>5 Years</option>
                                            </select>
                                        </div>
                                    </li>
                                    <li class="careerfy-column-6">
                                        <label>Age *</label>
                                        <div class="careerfy-profile-select">
                                            <select>
                                                <option>24</option>
                                                <option>24</option>
                                            </select>
                                        </div>
                                    </li>
                                    <li class="careerfy-column-6">
                                        <label>Current Salary($) *</label>
                                        <div class="careerfy-profile-select">
                                            <select>
                                                <option>$ 2400</option>
                                                <option>$ 2400</option>
                                            </select>
                                        </div>
                                    </li>
                                    <li class="careerfy-column-6">
                                        <label>Expected Salary($) *</label>
                                        <div class="careerfy-profile-select">
                                            <select>
                                                <option>$ 4500</option>
                                                <option>$ 4500</option>
                                            </select>
                                        </div>
                                    </li>
                                    <li class="careerfy-column-6">
                                        <label>Languages *</label>
                                        <div class="careerfy-profile-select">
                                            <select>
                                                <option>English</option>
                                                <option>English</option>
                                            </select>
                                        </div>
                                    </li>
                                    <li class="careerfy-column-6">
                                        <label>Education Levels *</label>
                                        <div class="careerfy-profile-select">
                                            <select>
                                                <option>B.sc Master</option>
                                                <option>B.sc Master</option>
                                            </select>
                                        </div>
                                    </li>
                                </ul>
                            </div> -->
                            <input type="submit" class="careerfy-employer-profile-submit" value="Save Setting">
                        </form>
                    </div>
                </div>

                {% endblock %}

            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="{% static 'employees/script/cropper.min.js' %}"></script>

    
<script>

    var bs_modal = $('#modal');
    var image = document.getElementById('image');
    var cropper,reader,fil;
   

    $("body").on("change", ".image", function(e) {
        var files = e.target.files;
        var done = function(url) {
            image.src = url;
            bs_modal.modal('show');
        };


        if (files && files.length > 0) {
            fil = files[0];

            if (URL) {
                done(URL.createObjectURL(fil));
            } else if (FileReader) {
                reader = new FileReader();
                reader.onload = function(e) {
                    done(reader.result);
                };
                reader.readAsDataURL(fil);
            }
        }
    });



    bs_modal.on('shown.bs.modal', function() {
        cropper = new Cropper(image, {
            aspectRatio: 1,
            viewMode: 2,
            preview: '.preview'
        });
    }).on('hidden.bs.modal', function() {
        cropper.destroy();
        cropper = null;
    });

    $("#crop").click(function() {
        console.log("in crop")
        canvas = cropper.getCroppedCanvas({
            width: 160,
            height: 160,
        });

        canvas.toBlob(function(blob) {
            url = URL.createObjectURL(blob);
            var reader = new FileReader();
            console.log("readerrrrrr",reader)
            reader.readAsDataURL(blob);
            reader.onloadend = function() {
                var base64data = reader.result;
                console.log(base64data);
                
                console.log("data after")
              
                

                $.ajax({
                    type: "get",
                    dataType: "json",
                    url: "{% url 'propic_save' %}",
                   
                    data: {image: base64data},
                    
                  
                });
                document.getElementById('image').src=base64data;
            };
        });
    });

</script>



{% endblock %}

</div>